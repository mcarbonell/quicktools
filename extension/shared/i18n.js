// FastTools Extension - i18n System

const translations = {
    es: {
        // Header
        greeting_morning: 'Â¡Buenos dÃ­as!',
        greeting_afternoon: 'Â¡Buenas tardes!',
        greeting_evening: 'Â¡Buenas noches!',
        greeting_default: 'Â¡Hola!',
        search_placeholder: 'ðŸ” Buscar herramientas...',
        
        // Stats
        stats_today: 'Usos Hoy',
        stats_favorite: 'Favorita',
        stats_time_saved: 'Tiempo Ahorrado',
        
        // Sections
        section_quick_access: 'âš¡ Acceso RÃ¡pido',
        section_all_tools: 'ðŸ› ï¸ Todas las Herramientas',
        section_notes: 'ðŸ“ Notas RÃ¡pidas',
        
        // Buttons
        btn_edit: 'âœï¸ Editar',
        btn_new: '+ Nueva',
        btn_save: 'Guardar',
        btn_cancel: 'Cancelar',
        btn_delete: 'ðŸ—‘ï¸ Eliminar',
        btn_close: 'Cerrar',
        
        // Categories (using English keys from web)
        category_all: 'Todo',
        category_image: 'ðŸ–¼ï¸ Imagen',
        category_data: 'ðŸ“Š Datos',
        category_text: 'ðŸ“ Texto',
        category_utils: 'ðŸ”§ Utilidades',
        category_ai: 'ðŸ¤– IA',
        category_files: 'ðŸ“ Archivos',
        category_converters: 'ðŸ”„ Conversores',
        category_generators: 'âœ¨ Generadores',
        
        // Timer
        timer_title: 'â° Temporizador',
        timer_start: 'Iniciar',
        timer_stop: 'Parar',
        timer_reset: 'Reset',
        
        // Colors
        colors_title: 'ðŸŽ¨ Colores Recientes',
        
        // Modals
        modal_settings: 'âš™ï¸ ConfiguraciÃ³n',
        modal_favorites: 'â­ Editar Acceso RÃ¡pido',
        modal_notes: 'ðŸ“ Editor de Notas',
        
        // Settings
        settings_appearance: 'ðŸŽ¨ Apariencia',
        settings_language: 'ðŸŒ Idioma',
        settings_theme: 'Tema:',
        settings_lang: 'Idioma:',
        theme_auto: 'AutomÃ¡tico',
        theme_light: 'Claro',
        theme_dark: 'Oscuro',
        lang_es: 'EspaÃ±ol',
        lang_en: 'English',
        
        // Notes
        note_title_placeholder: 'TÃ­tulo',
        note_content_placeholder: 'Escribe tu nota...',
        note_no_notes: 'No hay notas',
        note_untitled: 'Sin tÃ­tulo',
        
        // Favorites
        favorites_description: 'Selecciona hasta 8 herramientas para acceso rÃ¡pido:',
        
        // Messages
        msg_capture_started: 'Captura iniciada',
        msg_note_saved: 'Nota guardada',
        msg_note_deleted: 'Nota eliminada',
        msg_note_empty: 'La nota debe tener tÃ­tulo o contenido',
        msg_favorites_saved: 'Favoritos guardados',
        msg_settings_saved: 'ConfiguraciÃ³n guardada',
        msg_color_copied: 'Color {color} copiado',
        msg_timer_finished: 'â° Â¡Tiempo terminado!',
        
        // Usage
        usage_count: '{count} usos',
        usage_today: '{count} usos hoy'
    },
    en: {
        // Header
        greeting_morning: 'Good morning!',
        greeting_afternoon: 'Good afternoon!',
        greeting_evening: 'Good evening!',
        greeting_default: 'Hello!',
        search_placeholder: 'ðŸ” Search tools...',
        
        // Stats
        stats_today: 'Uses Today',
        stats_favorite: 'Favorite',
        stats_time_saved: 'Time Saved',
        
        // Sections
        section_quick_access: 'âš¡ Quick Access',
        section_all_tools: 'ðŸ› ï¸ All Tools',
        section_notes: 'ðŸ“ Quick Notes',
        
        // Buttons
        btn_edit: 'âœï¸ Edit',
        btn_new: '+ New',
        btn_save: 'Save',
        btn_cancel: 'Cancel',
        btn_delete: 'ðŸ—‘ï¸ Delete',
        btn_close: 'Close',
        
        // Categories (using English keys from web)
        category_all: 'All',
        category_image: 'ðŸ–¼ï¸ Image',
        category_data: 'ðŸ“Š Data',
        category_text: 'ðŸ“ Text',
        category_utils: 'ðŸ”§ Utils',
        category_ai: 'ðŸ¤– AI',
        category_files: 'ðŸ“ Files',
        category_converters: 'ðŸ”„ Converters',
        category_generators: 'âœ¨ Generators',
        
        // Timer
        timer_title: 'â° Timer',
        timer_start: 'Start',
        timer_stop: 'Stop',
        timer_reset: 'Reset',
        
        // Colors
        colors_title: 'ðŸŽ¨ Recent Colors',
        
        // Modals
        modal_settings: 'âš™ï¸ Settings',
        modal_favorites: 'â­ Edit Quick Access',
        modal_notes: 'ðŸ“ Note Editor',
        
        // Settings
        settings_appearance: 'ðŸŽ¨ Appearance',
        settings_language: 'ðŸŒ Language',
        settings_theme: 'Theme:',
        settings_lang: 'Language:',
        theme_auto: 'Auto',
        theme_light: 'Light',
        theme_dark: 'Dark',
        lang_es: 'EspaÃ±ol',
        lang_en: 'English',
        
        // Notes
        note_title_placeholder: 'Title',
        note_content_placeholder: 'Write your note...',
        note_no_notes: 'No notes',
        note_untitled: 'Untitled',
        
        // Favorites
        favorites_description: 'Select up to 8 tools for quick access:',
        
        // Messages
        msg_capture_started: 'Capture started',
        msg_note_saved: 'Note saved',
        msg_note_deleted: 'Note deleted',
        msg_note_empty: 'Note must have title or content',
        msg_favorites_saved: 'Favorites saved',
        msg_settings_saved: 'Settings saved',
        msg_color_copied: 'Color {color} copied',
        msg_timer_finished: 'â° Time\'s up!',
        
        // Usage
        usage_count: '{count} uses',
        usage_today: '{count} uses today'
    }
};

// Get browser language
export function getBrowserLanguage() {
    const lang = navigator.language || navigator.userLanguage;
    return lang.startsWith('es') ? 'es' : 'en';
}

// Get current language from storage or browser
export async function getCurrentLanguage() {
    try {
        const data = await chrome.storage.local.get('settings');
        return data.settings?.language || getBrowserLanguage();
    } catch {
        return getBrowserLanguage();
    }
}

// Set language
export async function setLanguage(lang) {
    try {
        const data = await chrome.storage.local.get('settings');
        const settings = data.settings || {};
        settings.language = lang;
        await chrome.storage.local.set({ settings });
        return true;
    } catch {
        return false;
    }
}

// Get translation
export function t(key, params = {}, lang = null) {
    const currentLang = lang || 'es'; // Default to Spanish
    let text = translations[currentLang]?.[key] || translations['es']?.[key] || key;
    
    // Replace params
    Object.keys(params).forEach(param => {
        text = text.replace(`{${param}}`, params[param]);
    });
    
    return text;
}

// Get category name
export function getCategoryName(category, lang = 'es') {
    const key = `category_${category.toLowerCase()}`;
    return t(key, {}, lang);
}

// Initialize i18n
export async function initI18n() {
    const lang = await getCurrentLanguage();
    return lang;
}

export default { t, getCategoryName, initI18n, getCurrentLanguage, getBrowserLanguage };
